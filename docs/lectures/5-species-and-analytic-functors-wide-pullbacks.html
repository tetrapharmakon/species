<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Species and analytic functors | Combinatorial species in TTU</title>
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Species and analytic functors" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This chapter embarks on a more category-theoretic study of species. Every species has a canonical decomposition as an infinite sum $f_0 + f_1 + f_2 + \dots$ and it gives rise to an endofunctor $\bar F $ of $\bf Set$ that admits a “Taylor expansion”. Such functors are called analytic, and they can be characterised intrinsically as the finitary endofunctors of $\bf Set$ satisfying a weak exactness property." />
<meta property="og:description" content="This chapter embarks on a more category-theoretic study of species. Every species has a canonical decomposition as an infinite sum $f_0 + f_1 + f_2 + \dots$ and it gives rise to an endofunctor $\bar F $ of $\bf Set$ that admits a “Taylor expansion”. Such functors are called analytic, and they can be characterised intrinsically as the finitary endofunctors of $\bf Set$ satisfying a weak exactness property." />
<link rel="canonical" href="http://localhost:4000/species/lectures/5-species-and-analytic-functors-wide-pullbacks.html" />
<meta property="og:url" content="http://localhost:4000/species/lectures/5-species-and-analytic-functors-wide-pullbacks.html" />
<meta property="og:site_name" content="Combinatorial species in TTU" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-14T12:13:21+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Species and analytic functors" />
<script type="application/ld+json">
{"url":"http://localhost:4000/species/lectures/5-species-and-analytic-functors-wide-pullbacks.html","@type":"BlogPosting","headline":"Species and analytic functors","dateModified":"2021-11-14T12:13:21+02:00","datePublished":"2021-11-14T12:13:21+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/species/lectures/5-species-and-analytic-functors-wide-pullbacks.html"},"description":"This chapter embarks on a more category-theoretic study of species. Every species has a canonical decomposition as an infinite sum $f_0 + f_1 + f_2 + \\dots$ and it gives rise to an endofunctor $\\bar F $ of $\\bf Set$ that admits a “Taylor expansion”. Such functors are called analytic, and they can be characterised intrinsically as the finitary endofunctors of $\\bf Set$ satisfying a weak exactness property.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link rel="stylesheet" href="/species/assets/css/style.css?v=">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
        onload="renderMathInElement(document.body,{macros:{ '':'', },delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}]});"></script>

      </head>
      <body>
        <header id="header">
          <nav>
            <a href="/species/">◂</a>
            <a href="http://tetrapharmakon.github.io">home</a>
          </nav>
        </header>

    <main>
      <article>
    <!-- &bull;  &bull; -->
    <h1>Species and analytic functors</h1>
    <p>This chapter embarks on a more category-theoretic study of species. Every species has a canonical decomposition as an infinite sum $f_0 + f_1 + f_2 + \dots$ and it gives rise to an endofunctor $\bar F $ of $\bf Set$ that admits a “Taylor expansion”. Such functors are called <em>analytic</em>, and they can be characterised intrinsically as the finitary endofunctors of $\bf Set$ satisfying a weak exactness property.</p>

<h3 id="analytic-functors-wide-pullbacks">Analytic functors, wide pullbacks</h3>

<div id="label-1"></div>
<p><strong>Construction.</strong> Given a combinatorial species $f : {\bf P} \to \bf Set$, we can consider the left Kan extension</p>

<p><span class="antex display"><img style='margin: 0.0ex 0.0ex -9.839ex 0.0ex; height: 12.677ex; width: 15.859ex;' src="/species/antex/493ab13ad796e7ba75fb7eae3990ae74.svg" /></span></p>

<p>and for $X\in\bf Set$ the set $FX$ can be computed pointwise as the coend</p>

<div class="kdmath">$$
\int^n f(n)\times X^n =: \left(\coprod_{n\ge 1} f(n)\times X^n\right)/\left\langle \begin{smallmatrix}\sigma.e; x_1,\dots,x_n) \sim (e, x_{\sigma 1},\dots, x_{\sigma n}) \\ \sigma \in S_n, n\ge 1\end{smallmatrix} \right\rangle \tag{$\star$}
$$</div>

<p>Such a functor is called <em>analytic</em>, and we call similarly every functor that lies in the image of the functor $\text{Lan}_J$, where $J : {\bf P} \hookrightarrow {\bf Set}$ is the (nonfull) inclusion functor.</p>

<div id="label-2"></div>
<p><strong>Definition</strong> (Analytic functor). An endofunctor $F$ of $\bf Set$ is called <em>analytic</em> if it lies in the essential image of $\text{Lan}_J$, or in other words, if it arises as the left Kan extension along $J : {\bf P} \hookrightarrow {\bf Set}$ of a combinatorial species $f : {\bf P} \to {\bf Set}$. Such a species will be called the <em>generating species</em> of $F$.</p>

<p>It is then evident that $\text{Lan}_J$ is the left adjoint in a pair</p>

<div class="kdmath">$$
\text{Lan}_J :  {\bf Spc} \leftrightarrows [{\bf Set}, {\bf Set}] : J^*.
$$</div>

<p>Since $J$ is not fully faithful, the category of combinatorial species cannot be seen as a full subcategory of endofunctors of $\bf Set$ subject to some additional property prescribed by the coreflection $J^*$.</p>

<p>Its essential image is thus a little bit more difficult to characterise than in the case of $[{\bf Fin}, {\bf Set}]$ examined in lecture 1.</p>

<p>With a little bit more effort, we can however characterise such an essential image as the subcategory of those $F : {\bf Set} \to {\bf Set}$ such that</p>

<ol>
  <li>$F$ is finitary;</li>
  <li>$F$ weakly preserves wide pullbacks.</li>
</ol>

<p>The second condition deserves a bite more explanation.</p>

<div id="label-3"></div>
<p><strong>Definition.</strong> An endofunctor $F : {\bf Set} \to {\bf Set}$ is said to <em>weakly preserve pullbacks</em> if for every pullback square</p>

<p><span class="antex display"><img style='margin: 0.0ex 0.0ex -10.006ex 0.0ex; height: 11.71ex; width: 18.209ex;' src="/species/antex/f142a101a99d3035944e76a7087e5ffc.svg" /></span></p>

<p>the canonical map $F(A\times_C B) \to FA \times_{FC} FB$ is surjective.</p>

<div id="label-4"></div>
<p><strong>Definition.</strong> Let $E$ be a set and $\cal C$ a category; a <em>($E$-ary) wide pullback</em> with sink $X \in \cal C$ is the limit of a diagram $E \to {\cal C}/X$ where $E$ is regarded as a discrete category and ${\cal C}/X$ is the slice of $\cal C$ over $X$.</p>

<p>In simple terms, a wide pullback is a pullback having possibly more than two arrows pointing to the same object.</p>

<p>In more obscure terms, let $E$ be a set, and let $E^\rhd$ be the category where a distinguished new object $\infty$ has been forcefully rendered a terminal object; a $E$-ary wide pullback in $\cal C$ is a limit of a diagram $E^\rhd \to \cal C$.</p>

<p>The characterisation of analytic functors in terms of weak preservation of wide pullbacks was first shown by Joyal in his “<em>Foncteurs analytiques</em>”.</p>

<p>The proof will occupy the entire lecture, and it comes from a more modern presentation of this idea in Adamek-Velebil that is purely elementary, in the sense that it relies on elementary category theory and is pretty straightforward.</p>

<h3 id="canonical-decomposition-and-examples">Canonical decomposition and examples</h3>

<p>Since $\text{Lan}_J$ is a left adjoint, it is evident that $\text{Lan}_J(f \sqcup g) \cong \text{Lan}_J f \sqcup \text{Lan}_J g$, so that the class of analytic functors is close under finite (and in fact, arbitrarily large) coproducts. More importantly, the analytic functor associated to $f\sqcup g$ is just the coproduct of the analytic functors $F=\text{Lan}_Jf$ and $G=\text{Lan}_Jg$.</p>

<p>Thus, to completely understand analytic functors, it is enough to understand the $\sqcup$-indecomposable objects of $\bf Spc$. Such indecomposable objects can be characterised.</p>

<div id="label-5"></div>
<p><strong>Proposition</strong> (Canonical decomposition of a species). Every combinatorial species $f : {\bf P} \to {\bf Set}$ splits into a countable sequence of $\sqcup$-indecomposable objects, unique up to reordering: the <em>canonical decomposition</em> of $f$.</p>

<p><em>Proof.</em> The category ${\bf P}$ splits as a coproduct of groups, namely ${\bf P} = \coprod_{n\ge 1} S_n$, so that a functor $f : {\bf P} \to {\bf Set}$ is in fact determined by a countable family of (left) $S_n$-sets $f_n : S_n \times X_n \to X_n$ under the isomorphism</p>

<div class="kdmath">$$
\textstyle {\bf Spc} = [{\bf P}, {\bf Set}] \cong \left[ \coprod_{n\ge 1} S_n , {\bf Set}\right] \cong \prod_{n\ge 1} [S_n, {\bf Set}]
$$</div>

<p>keeping in mind that the category $[S_n, {\bf Set}]$ is just the category of sets equipped with a left $S_n$-action. Thus, the action of $f$ on objects and morphisms is determined as the sum $f_1 + f_2 + f_3 + \dots$</p>

<div id="label-6"></div>
<p><strong>Corollary.</strong> Since the decomposition of a species $f$ as a sum $f_1 + f_2 + f_3 + \dots$ is uniquely determined, the following concepts are well defined:</p>

<ul>
  <li>the <em>odd part</em> $f_o$ of a species $f : {\bf P} \to {\bf Set}$ consisting of the sum $\sum_{k\ge 0} f_{2k+1}=f_1+f_3+\dots$;</li>
  <li>the <em>even part</em> $f_o$ of a species $f : {\bf P} \to {\bf Set}$ consisting of the sum $\sum_{k\ge 1} f_{2k}=f_2+f_4+\dots$.</li>
</ul>

<p>The following <em>splitting formula</em> for the cycle index series of the even and odd part of a species $f$ holds true:</p>

<div class="kdmath">$$
\begin{cases} Z_{E_e} = \frac12 \left( Z_E(x_1, x_2,x_3,\dots) + Z_E(-x_1,x_2,-x_3,\dots)\right) \\ Z_{E_o} = \frac12 \left( Z_E(x_1, x_2,x_3,\dots) - Z_E(-x_1,x_2,-x_3,\dots)\right). \end{cases}
$$</div>

<div id="label-7"></div>
<p><strong>Example.</strong> Let $f : {\bf P} \to {\bf Set}$ be the sym-representable species sending $[n]\mapsto S_n/H$; the associated analytic functor sends a set $X$ to the set $X^n/H$, where the tuples of elements of $X$ are identified iff they differ by a permutation in $H$.</p>

<p>The functor $X\mapsto X^n/H$ is called <em>sym-representable analytic</em>.</p>

<p>As an important corollary of the previous example and of the canonical decomposition, we obtain that every analytic functor splits into a disjoint union of sym-representables as follows: Let $F$ be analytic; then the equivalence relation in the coend $(\star)$ acts separately on each summand, and yields the decomposition of $FX$ as a coproduct $FX = \coprod_{n\ge 1} \frac{f(n)\times X^n}{\sim}$, where $\sim$ is the equivalence relation consisting of all pairs $(e;\vec x) \sim (f(\sigma).e; \vec x \cdot \sigma)$.</p>

<p>Writing the above coproduct as a sum and interpreting the quotient as a “fraction by $n!$”, we get that every analytic functor admits a <em>Taylor series expansion</em></p>

<div class="kdmath">$$
FX = \sum_{n\ge 1} \frac{f(n)\times X^n}{n!}.
$$</div>

<div id="label-8"></div>
<p><strong>Example</strong> (The AF of the species of singletons). Recall that the species $U$ of singletons is defined as the species centered in $1$, with value a one-element set. So, the colimit that computes $\text{Lan}_J U$ reduces to be the identity functor ${\bf Set} \to {\bf Set}$.</p>

<div id="label-9"></div>
<p><strong>Example</strong> (The AF of a representable species). The species <a href="2-p-and-its-up-and-species.html#label-3">concentrated</a> in $n\ge 1$ over the set $S_n$ gives rise to the functor $X\mapsto {\bf Set}(Jn, X)=X^n$ raising $X$ to the $n$th power.</p>

<div id="label-10"></div>
<p><strong>Example</strong> (The AF of the species of sets). The <a href="2-p-and-its-up-and-species.html#label-5">species of sets</a> $E$ gives rise to the analytic functor sending a set $X$ to the set of <em>finite multisets</em> on $X$, i.e. finite $\mathbb N$-linear combinations of elements of $X$ like $3x+y+z$ or $x+2y+11w+t$…</p>

<p>From the colimit formula for $\text{Lan}_JE$ we derive that $\tilde E$ sends $X$ to $\sum_n X^n/S_n$ (quotient sets), and this means that in an $n$-tuple of elements of $X$, the order of the coordinates does not matter, but the number of repetitions does.</p>

<div id="label-11"></div>
<p><strong>Example</strong> (The AF of the species of permutations). The species of <a href="2-p-and-its-up-and-species.html#label-6">permutations</a> gives rise to the analytic functor sending $X$ to $\sum_n X^n$. This functor builds the free monoid (if the sum starts from 0) or the free semigroup (if the sum starts from 1) on the set $X$.</p>

<div id="label-12"></div>
<p><strong>Example</strong> (The AF of the species of oriented cycles).</p>

<div id="label-12-bis"></div>
<p><strong>Example</strong> (The AF of the species of subsets).</p>

<p>We now embark on the proof of the characterisation theorem for analytic functors. We provide an elementary proof in two parts.</p>

<div id="label-13"></div>
<p><strong>Definition.</strong> An endofunctor of $\bf Set$ is called <em>superfinitary</em> if there exists a finite set $[n] = \{1,dots,n\}$ with the property that for each $X \in \bf Set$, the set $FX$ is the union of the images of $Fh$’s, with $h : [n] \to X$. In simple words, $F$ is superfinitary if, there exists an $n\ge 0$ such that for every set $X$, $FX$ is generated by the set $X^n$. Note that in this definition, $n$ is <em>the same</em> for all $X$’s.</p>

<p>Observe that if $F$ is superfinitary,</p>

<ol>
  <li>we can choose a <em>minimal</em> $n$ with the property that $X^n$ generates $FX$; say this minimal $n$ is called $n_0$. Then,</li>
  <li>there exists $x_0 \in Fn_0$ which is minimal, i.e. such that $x_0$ does not lie in the image of any $F(f : [k] \hookrightarrow [n])$ for $[k]$ a proper subobject of $[n]$ (this would violate minimality).</li>
</ol>

<p><strong>Lemma.</strong> Every endofunctor $F$ of $\bf Set$ is the coproduct (in the category $[{\bf Set}, {\bf Set}]$) of functors $F_i$ that preserve the terminal object.</p>

<p><em>Proof.</em> The coproduct will be indexed by the set $F1$; given $x\in F1$, define the functor $F_x : {\bf Set} \to {\bf Set}$ sending $A$ to the fiber of $Ft_A$ over $x$, if $t_A : A \to 1$ is the terminal map. On morphisms, a map $A\to B$ defines a function $(Ft_A)^\leftarrow(x) \to (Ft_B)^\leftarrow(x)$. Clearly, this is a functor, and each $F_x$ sends $1$ to $F(\text{id}_1)(x)=\{x\}$, so it preserves the terminal object.</p>

<p>It is equally clear that $F$ results as the coproduct $\sum_{x\in F1} F_x$, because each $FA$ is isomorphic to the sum $\sum_{x\in F1} (Ft_A)^\leftarrow x$ (we are secretly using the equivalence of categories ${\bf Set}/F1 \cong {\bf Set}^{F1}$).</p>

<p>This apparently simple lemma has powerful consequences: when we want to prove a statement for a certain class ${\cal A}$ of endofunctors of $\bf Set$, and $\cal A$ is stable under coproducts, we can assume that an endofunctor in $\cal A$ preserves the terminal object.</p>

<p>A particular case of such an $\cal A$ is the class of analytic functors.</p>

<div id="label-14"></div>
<p><strong>Theorem</strong> (Characterisation of analytic functors, I). For a superfinitary functor $F : {\bf Set} \to {\bf Set}$ the following conditions are equivalent:</p>

<ol>
  <li>$F$ weakly preserves pullbacks;</li>
  <li>$F$ is analytic;</li>
  <li>$F$ splits as a coproduct of sym-representables.</li>
</ol>

<p>When this is proved, the assumption of superfinitariness (is that even a name…?) can be removed obtaining Joyal’s characterisation of $\cal A$.</p>

<div id="label-15"></div>
<p><strong>Theorem</strong> (Characterisation of analytic functors, II). For a finitary functor $F : {\bf Set} \to {\bf Set}$ the following conditions are equivalent:</p>

<ol>
  <li>$F$ is analytic;</li>
  <li>$F$ is a coproduct of symmetrised representables;</li>
  <li>$F$ weakly preserves <em>countable</em> wide pullbacks;</li>
  <li>$F$ weakly preserves wide pullbacks (of all cardinality).</li>
</ol>

<h3 id="proof-of-the-first-theorem">Proof of the first theorem</h3>

<p>Let’s prove that $(1 \Rightarrow 3)$. First of all, we can assume that $F1\cong 1$. Note that as a consequence $F$ weakly preserve products, because it weakly preserves the pullback</p>

<p><span class="antex display"><img style='margin: 0.0ex 0.0ex -9.929ex 0.0ex; height: 11.632ex; width: 16.562ex;' src="/species/antex/067fe882a34c3544bb2b4477cd12165b.svg" /></span></p>

<p>This means that provided we choose a minimal $n_0, x_0$ as in <a href="">the previous remark</a>, every $f : X \to [n]$ such that $x_0$ lies in the image of $Ff$ must be an epimorphism.</p>

<p>In particular, all elements in the set</p>

<div class="kdmath">$$
\text{Fix}(F|x_0) := \{ f : [n] \to [n] \mid Ff(x_0)=x_0 \}
$$</div>

<p>are epimorphisms, and since $[n]$ is finite, they must be bijection as well. This determines a subgroup $H_F \le S_n$.</p>

<p>We shall show that there exists an isomorphism of functors $\tilde{\xi}_{x_0} : {\bf P}(n,-)/H_F \cong F$, where ${\xi}_{x_0}$ is the unique natural transformation corresponding to $x_0$ via Yoneda.</p>

<p>First of all, $\xi_{x_0}$ descends to the quotient “exactly”, in the sense that $\xi_{x_0}u=\xi_{x_0}v$ if and only if $u,v$ lie in the same $H_F$-orbit (if: obvious; only if: the pullback of $u$ against $v$ must be weakly preserved by $F$), and thus defines an injective function $\tilde{\xi}_{x_0} : {\bf P}(n,-)/H_F \hookrightarrow F$; using that $F$ weakly preserves pullbacks, we can show that $\tilde{\xi}_{x_0}$ is also surjective: given $y\in Fn$, there exist $f : n\times n \to n$ and $z\in Fn$ such that $F\pi_1 z=x_0$ and $F\pi_2 z = y$. But then $\pi_1f\in \text{Fix}(F|x_0)$, so it is invertible. Then, $\xi_{x_0}u=y$ if we fix $u=\pi_2 f (\pi_1 f)^{-1}$.</p>

<p>The implication that $(3 \Rightarrow 2)$ is evident from the fact that each sym-representable is analytic, and $\cal A$ is closed under coproducts.</p>

<p>Finally, let’s prove that $(2 \Rightarrow 1)$.</p>

<p><strong>Remark.</strong> The proof of the second theorem, which was the one initially proved by Joyal, follows from a similar argument; in particular, the implication $3\Rightarrow 2$ follows from the fact that each $F$ that weakly preserves countable wide pullbacks is superfinitary (prove this by contradiction as an exercise). All other implications are trivial or follow clearly from what we already know.</p>

</article>
    </main>

    <footer id="footer">
      <nav>
        <a href="/species/">◂</a>
        <a href="#header">▴</a>
      </nav>
    </footer>
  </body>
</html>
